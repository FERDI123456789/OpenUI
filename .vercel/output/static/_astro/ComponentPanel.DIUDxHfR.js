import{j as e,b as g,u as b}from"./use_queries.BAwlYwYt.js";import{R as $,r as d}from"./index.WxXIy71t.js";import{a as h}from"./api.BHjxwVAw.js";function H(t){let s=t.trim();return s=s.replace(/export\s+default\s+function\s+([A-Za-z0-9_]+)?/,(a,r)=>`function ${r||"App"}`).replace(/export\s+function\s+([A-Za-z0-9_]+)/g,"function $1").replace(/export\s+const\s+([A-Za-z0-9_]+)/g,"const $1"),s=s.replace(/import\s+React.*from\s+['"]react['"];?/g,"const React = window.React;"),s=s.replace(/import\s+{([^}]+)}\s+from\s+['"]react['"];?/g,"const { $1 } = React;"),!/function\s+App/.test(s)&&!/const\s+App\s*=/.test(s)&&(s=`const App = () => (${s});`),s}function _({code:t,language:s,css:a,viewportMode:r="desktop"}){const p=$.useRef(null);return $.useEffect(()=>{if(!p.current)return;const l=p.current.contentDocument||p.current.contentWindow?.document;if(!l)return;let i="",o="";s==="html"?i=t:s==="jsx"&&(i='<div id="root"></div>',o=`
        <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"><\/script>
        <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"><\/script>
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"><\/script>
        <script type="text/babel" data-presets="react">
          ${H(t).replace(/\\/g,"\\\\").replace(/`/g,"\\`").replace(/\${/g,"\\${")}
          const mountNode = document.getElementById('root');
          if (ReactDOM.createRoot) {
            const root = ReactDOM.createRoot(mountNode);
            root.render(React.createElement(App));
          } else {
            ReactDOM.render(React.createElement(App), mountNode);
          }
        <\/script>
      `);const u=`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="${r==="mobile"?`width=${r==="mobile"?"375":"device-width"}, initial-scale=1.0, maximum-scale=1.0, user-scalable=no`:"width=device-width, initial-scale=1.0"}">
          <script src="https://cdn.tailwindcss.com"><\/script>
          <style>
            body { margin: 0; padding: 16px; font-family: system-ui, -apple-system, sans-serif; }
            ${a||""}
          </style>
        </head>
        <body>
          ${i}
          ${o}
        </body>
      </html>
    `;l.open(),l.write(u),l.close()},[t,s,a,r]),e.jsx("iframe",{ref:p,sandbox:"allow-scripts allow-same-origin",className:"w-full border-0 bg-white",style:{minHeight:r==="mobile"?"667px":"600px",height:r==="mobile"?"667px":"600px",maxWidth:r==="mobile"?"375px":"100%",margin:r==="mobile"?"0 auto":"0"},title:"Component Preview"})}/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),U=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,a,r)=>r?r.toUpperCase():a.toLowerCase()),M=t=>{const s=U(t);return s.charAt(0).toUpperCase()+s.slice(1)},A=(...t)=>t.filter((s,a,r)=>!!s&&s.trim()!==""&&r.indexOf(s)===a).join(" ").trim(),V=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var D={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=d.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:p="",children:l,iconNode:i,...o},n)=>d.createElement("svg",{ref:n,...D,width:s,height:s,stroke:t,strokeWidth:r?Number(a)*24/Number(s):a,className:A("lucide",p),...!l&&!V(o)&&{"aria-hidden":"true"},...o},[...i.map(([c,u])=>d.createElement(c,u)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=(t,s)=>{const a=d.forwardRef(({className:r,...p},l)=>d.createElement(F,{ref:l,iconNode:s,className:A(`lucide-${P(M(t))}`,`lucide-${t}`,r),...p}));return a.displayName=M(t),a};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M12.409 5.824c-.702.792-1.15 1.496-1.415 2.166l2.153 2.156a.5.5 0 0 1 0 .707l-2.293 2.293a.5.5 0 0 0 0 .707L12 15",key:"idzbju"}],["path",{d:"M13.508 20.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5a5.5 5.5 0 0 1 9.591-3.677.6.6 0 0 0 .818.001A5.5 5.5 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5z",key:"1su70f"}]],Z=z("heart-crack",O);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],j=z("heart",T);function q({component:t,onToggleSave:s,isSaved:a,userId:r,onCopyComponent:p,getLanguageBadgeColor:l}){const[i,o]=d.useState("desktop"),[n,c]=d.useState("preview"),[u,x]=d.useState(!1);if(!t)return null;const f=()=>a?u?e.jsx(Z,{className:"w-8 h-8"}):e.jsx(j,{className:"w-8 h-8",fill:"#7f1d1d"}):u?e.jsx(j,{className:"w-8 h-8",fill:"#7f1d1d"}):e.jsx(j,{className:"w-8 h-8"});return e.jsxs("div",{className:"p-6 overflow-y-auto h-full bg-transparent component-panel",style:{animation:"fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1), slideInRight 0.5s cubic-bezier(0.4, 0, 0.2, 1)"},children:[e.jsx("div",{className:"mb-4 space-y-2",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex px-3 py-1.5 rounded-lg text-xs font-semibold border ${l(t.language)}`,children:t.language.toUpperCase()}),t.user?.username&&e.jsxs("p",{className:"text-xs text-gray-400",children:["von"," ",e.jsx("span",{className:"text-purple-400 font-medium",children:t.user.username})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-800/40 backdrop-blur-sm border border-purple-800/30 rounded-xl p-1",children:[e.jsx("button",{onClick:()=>c("preview"),className:`p-2 rounded-lg transition-all duration-200 ${n==="preview"?"bg-purple-600/30 text-purple-300 shadow-lg shadow-purple-500/20":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,title:"Vorschau",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),e.jsx("button",{onClick:()=>c("code"),className:`p-2 rounded-lg transition-all duration-200 ${n==="code"?"bg-purple-600/30 text-purple-300 shadow-lg shadow-purple-500/20":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,title:"Code-Ansicht",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})})]}),n==="preview"&&e.jsxs("div",{className:"flex items-center gap-2 bg-gray-800/40 backdrop-blur-sm border border-purple-800/30 rounded-xl p-1",children:[e.jsx("button",{onClick:()=>o("mobile"),className:`p-2 rounded-lg transition-all duration-200 ${i==="mobile"?"bg-purple-600/30 text-purple-300 shadow-lg shadow-purple-500/20":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,title:"Handy-Ansicht",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),e.jsx("button",{onClick:()=>o("desktop"),className:`p-2 rounded-lg transition-all duration-200 ${i==="desktop"?"bg-purple-600/30 text-purple-300 shadow-lg shadow-purple-500/20":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,title:"Desktop-Ansicht",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),s&&e.jsx("button",{onClick:s,disabled:!r,className:"text-red-400 hover:text-red-300 transition-colors",title:r?a?"Unsave":"Save":"Login to save",onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:f()})]})]})}),n==="preview"?e.jsxs("div",{className:`mt-4 border border-purple-800/30 rounded-xl overflow-hidden bg-gray-900/40 shadow-inner transition-all duration-300 flex items-center justify-center ${i==="mobile"?"max-w-[600px] mx-auto h-[900px] relative":"h-[600px] w-full"}`,children:[i==="mobile"&&e.jsxs("div",{className:"absolute inset-0 pointer-events-none z-10",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-6 bg-gray-700 rounded-t-xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-6 bg-gray-700 rounded-b-xl"})]}),e.jsx("div",{className:`w-full h-full transition-all duration-300 ${i==="mobile"?"rounded-[2.5rem] scale-75 origin-top":""}`,children:e.jsx(_,{code:t.code,css:t.css,language:t.language,viewportMode:i})})]}):e.jsxs("div",{className:"mt-4 border border-purple-800/30 rounded-xl overflow-hidden bg-gray-900/40 shadow-inner",children:[e.jsx("div",{className:"p-4 bg-gray-800/50 border-b border-purple-800/30",children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`inline-flex px-3 py-1.5 rounded-lg text-xs font-semibold border ${l(t.language)}`,children:t.language.toUpperCase()}),t.css&&e.jsx("span",{className:"inline-flex px-3 py-1.5 rounded-lg text-xs font-semibold border bg-pink-500/20 text-pink-400 border-pink-500/30",children:"CSS"})]})}),e.jsxs("div",{className:"p-4 space-y-4 max-h-[600px] overflow-y-auto",children:[t.css&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-purple-300 mb-2 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),"CSS"]}),e.jsx("pre",{className:"bg-gray-950/50 p-4 rounded-lg border border-purple-800/20 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-gray-300 font-mono",children:t.css})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-purple-300 mb-2 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),t.language.toUpperCase()," Code"]}),e.jsx("pre",{className:"bg-gray-950/50 p-4 rounded-lg border border-purple-800/20 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-gray-300 font-mono whitespace-pre-wrap",children:t.code})})]})]})]})]})}function Y({selectedComponent:t,setSelectedComponent:s,onClose:a,getLanguageBadgeColor:r,handleTogglePublish:p}){const[l,i]=d.useState(!1),o=typeof window<"u"?localStorage.getItem("userId"):null,n=t?._id,c=g(h.components.getPublicComponentById,n?{id:n}:"skip")||t,u=g(h.components.getUserProfile,c?.userId?{userId:c.userId}:"skip"),x={...c,user:u},f=c?.userId===o,y=g(h.components.isSaved,o&&n?{componentId:n,userId:o}:"skip"),[k,v]=d.useState(!1);d.useEffect(()=>{v(y??!1)},[y]);const C=g(h.components.isCopied,o&&n?{componentId:n,userId:o}:"skip"),[S,w]=d.useState(!1);d.useEffect(()=>{w(C??!1)},[C]);const I=b(h.components.saveComponent),R=b(h.components.unsaveComponent),W=b(h.components.copyComponent);b(h.components.uncopyComponent),d.useEffect(()=>{if(t){document.body.style.overflow="hidden";const m=requestAnimationFrame(()=>{i(!0)});return()=>{cancelAnimationFrame(m),document.body.style.overflow=""}}else document.body.style.overflow=""},[t]);const N=()=>{i(!1),document.body.style.overflow="",setTimeout(()=>a(),500)},E=async()=>{if(!o||!n)return;const m=!k;v(m);try{m?await I({componentId:n,userId:o}):await R({componentId:n,userId:o})}catch(L){console.error("Save toggle failed:",L),v(!m),alert(L.message||"Failed to save component")}},B=async()=>{if(!(!o||!n||S)){w(!0);try{await W({componentId:n,userId:o})}catch(m){console.error("Copy failed:",m),w(!1),alert(m.message||"Failed to copy component")}}};return t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed inset-0 bg-black/40 backdrop-blur-sm z-40 transition-all duration-500 ease-out ${l?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:N,style:{transition:"opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1), backdrop-filter 0.5s cubic-bezier(0.4, 0, 0.2, 1)"}}),e.jsxs("div",{className:`fixed top-0 right-0 h-full w-[85%] max-w-4xl bg-gradient-to-br from-gray-900 via-gray-900 to-purple-900/20 backdrop-blur-md shadow-2xl shadow-purple-900/30 z-50 component-panel rounded-l-3xl ${l?"translate-x-0 opacity-100":"translate-x-full opacity-0"}`,style:{transition:"transform 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1)",willChange:"transform, opacity",borderLeft:"1px solid rgba(147, 51, 234, 0.1)"},children:[e.jsxs("div",{className:"p-6 flex justify-between items-center text-black border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold",children:c.name}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("p",{className:"flex items-center gap-1 text-sm font-bold text-red-900",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("rect",{width:"24",height:"24",fill:"none"}),e.jsx("path",{fill:"currentColor",d:"M13.5 20c-6.6-6.1-10-9.2-10-12.9C3.5 4 5.9 1.6 9 1.6c1.7 0 3.4.8 4.5 2.1c1.1-1.3 2.8-2.1 4.5-2.1c3.1 0 5.5 2.4 5.5 5.5c0 3.8-3.4 6.9-10 12.9M12 21.1C5.4 15.2 1.5 11.7 1.5 7v-.6c-.6.9-1 2-1 3.2c0 3.8 3.4 6.9 10 12.8z","stroke-width":"0.5",stroke:"currentColor"})]}),c.saveCount||0]}),e.jsxs("p",{className:"flex items-center gap-1 text-sm font-bold text-blue-900",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("rect",{width:"24",height:"24",fill:"none"}),e.jsx("path",{fill:"currentColor",d:"M4 7H2v14c0 1.1.9 2 2 2h14v-2H4M20 3h-3.2c-.4-1.2-1.5-2-2.8-2s-2.4.8-2.8 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-6 0c.6 0 1 .5 1 1s-.5 1-1 1s-1-.5-1-1s.4-1 1-1m-1.7 12.1L9 11.8l1.4-1.4l1.9 1.9L17.6 7L19 8.4","stroke-width":"0.5",stroke:"currentColor"})]}),c.copyCount||0]}),p&&e.jsx("button",{onClick:()=>p(t._id),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${c?.published?"bg-gray-300 text-black hover:bg-gray-400":"bg-green-600 text-white hover:bg-green-500"}`,children:c?.published?"Unpublish":"Publish"}),e.jsx("button",{onClick:N,className:"text-gray-400 hover:text-white hover:bg-gray-700/50 p-2 rounded-lg transition-colors text-xl font-bold",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx(q,{component:x,onToggleSave:f?void 0:E,isSaved:k,userId:o,onCopyComponent:f?void 0:B,getLanguageBadgeColor:r})]})]}):null}export{_ as C,Y as a};
